"use strict";function renderDelete(e){var o="#"+e.target.id;jQuery.post(ajaxurl,{action:"sn_core_delete_file",filename:jQuery(o).dialog("option","file_path"),hash:jQuery(o).dialog("option","file_hash"),_ajax_nonce:wf_sn_cs.nonce},(function(e){e?e.err?jQuery(o).html("<p><b>An error occured.</b> "+e.err+"</p>"):(jQuery(o).html(e.out),jQuery("#sn-delete-file").focus(),jQuery("#sn-delete-file").on("click",(function(){jQuery(this).attr("disabled","disabled").attr("value","Please wait ..."),jQuery.post(ajaxurl,{action:"sn_core_delete_file_do",_ajax_nonce:wf_sn_cs.nonce,filename:jQuery(this).attr("data-filename")},(function(e){if("1"==e){var t=jQuery(o).dialog("option","file_hash");jQuery(o).dialog("close"),jQuery('[data-hash="'+t+'"]').closest("li").fadeOut("slow",(function(){jQuery(this).remove()}))}else alert("An error occured - "+e),jQuery(this).attr("disabled","").attr("value","Delete File")}))}))):(alert("An undocumented error occured. The page will reload."),window.location.reload())}),"json")}function renderSource(e){var o="#"+e.target.id;jQuery.post(ajaxurl,{action:"sn_core_get_file_source",filename:jQuery("#source-dialog").dialog("option","file_path"),hash:jQuery("#source-dialog").dialog("option","file_hash"),_ajax_nonce:wf_sn_cs.nonce},(function(e){e?e.err?jQuery(o).html("<p><b>An error occured.</b> "+e.err+"</p>"):(jQuery(o).html('<pre class="sn-core-source"></pre>'),jQuery("pre",o).text(e.source),jQuery("pre",o).snippet(e.ext,{style:"whitengrey"})):(alert("An undocumented error occured. The page will reload."),window.location.reload())}),"json")}function renderRestore(e){var o="#"+e.target.id;jQuery.post(ajaxurl,{action:"sn_core_restore_file",_ajax_nonce:wf_sn_cs.nonce,filename:jQuery(o).dialog("option","file_path"),hash:jQuery(o).dialog("option","file_hash")},(function(e){e?e.err?jQuery(o).html("<p><b>An error occured.</b> "+e.err+"</p>"):(jQuery(o).html(e.out),jQuery("#sn-restore-file").on("click",(function(){jQuery(this).attr("disabled","disabled").attr("value","Please wait ..."),jQuery.post(ajaxurl,{action:"sn_core_restore_file_do",_ajax_nonce:wf_sn_cs.nonce,filename:jQuery(this).attr("data-filename")},(function(e){"1"==e?window.location.reload():(alert("An error occured - "+e),jQuery(this).attr("disabled","").attr("value","Restore file"))}))}))):(alert("An undocumented error occured. The page will reload."),window.location.reload())}),"json")}function fixDialogClose(e){jQuery(".ui-widget-overlay").bind("click",(function(){jQuery("#"+e.target.id).dialog("close")}))}jQuery(document).ready((function(e){e(document).on("click","#wf-cs-delete-all-unknown-button",(function(){return!!confirm("Are you sure you want to delete all unknown files?")})),e("button.sn-show-source").click((function(){return e(e(this).attr("href")).dialog("option",{title:"File source: "+e(this).attr("data-file"),file_path:e(this).attr("data-file"),file_hash:e(this).attr("data-hash")}).dialog("open"),!1})),e("button.sn-restore-source").click((function(){return e(e(this).attr("href")).dialog("option",{title:"Restore file: "+e(this).attr("data-file-short"),file_path:e(this).attr("data-file"),file_hash:e(this).attr("data-hash")}).dialog("open"),!1})),e("button.sn-delete-source").click((function(){return e(e(this).attr("href")).dialog("option",{title:"Delete file: "+e(this).attr("data-file-short"),file_path:e(this).attr("data-file"),file_hash:e(this).attr("data-hash")}).dialog("open"),!1})),e("#delete-dialog").dialog({dialogClass:"wp-dialog",modal:!0,resizable:!1,zIndex:9999,width:800,height:250,hide:"fade",open:function(e,o){renderDelete(e,o),fixDialogClose(e,o)},close:function(){jQuery("#delete-dialog").html("<p>Please wait.</p>")},show:"fade",autoOpen:!1,closeOnEscape:!0}),e("#source-dialog").dialog({dialogClass:"wp-dialog",modal:!0,resizable:!1,zIndex:9999,width:800,height:550,hide:"fade",open:function(e,o){renderSource(e,o),fixDialogClose(e,o)},close:function(){jQuery("#source-dialog").html("<p>Please wait.</p>")},show:"fade",autoOpen:!1,closeOnEscape:!0}),e("#restore-dialog").dialog({dialogClass:"wp-dialog",modal:!0,resizable:!1,zIndex:9999,width:600,height:350,hide:"fade",open:function(e,o){renderRestore(e,o),fixDialogClose(e,o)},close:function(){jQuery("#restore-dialog").html("<p>Please wait.</p>")},show:"fade",autoOpen:!1,closeOnEscape:!0}),e("#sn-run-core-scan").click((function(o){o.preventDefault();var t={action:"sn_core_run_scan",_ajax_nonce:wf_sn_cs.nonce};sn_block_ui("#sn-core-scanner"),e.get(ajaxurl,t,(function(e){"1"!=e?(alert("Error. Please check Events tab for details. Page will reload when you click OK."),window.location.reload()):window.location.reload()}),"html")}))}));