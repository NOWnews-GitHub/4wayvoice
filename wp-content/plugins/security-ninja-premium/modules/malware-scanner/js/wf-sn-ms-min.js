"use strict";function updateTimeCounter(){++totalSeconds,mssecondsLabel.innerHTML=pad(totalSeconds%60),msminutesLabel.innerHTML=pad(parseInt(totalSeconds/60))}function pad(e){var n=e+"";return n.length<2?"0"+n:n}var msminutesLabel=document.getElementById("mscounterminutes"),mssecondsLabel=document.getElementById("mscounterseconds"),totalSeconds=0,actions=[{msg1:"Cleaning cache ... ",msg2:" DONE!",action:"clean_cache"},{msg1:"Checking malware definitions",msg2:"DONE!",action:"update_samples"},{msg1:"Checking plugins for modifications",msg2:"DONE!",action:"do_integrity_scan"},{msg1:"Scanning website for malicious code",msg2:"DONE!",action:"do_mal_scan"},{msg1:"Generating results ... ",msg2:"DONE!",action:"get_results"}];function ShieldAgainstThirdPartyErrors(e){jQuery("#sn_ms_run_scan").on("click",(function(e){e.preventDefault(),jQuery("#scanstatus").html(),setInterval(updateTimeCounter,1e3);var n=jQuery.Deferred();n.resolve(),jQuery("#sn_ms_results").html(""),jQuery("ul.malware-scan-list").html(""),jQuery(".wrap .error").hide(),jQuery.each(actions,(function(e,n){jQuery("ul.malware-scan-list").append('<li id="msg_'+n.action+'" class="pending">'+n.msg1+' <span class="badge">Waiting ...</span></li>')})),jQuery(".loader").hide(),sn_block_ui("#sn-malware-scanner"),jQuery.each(actions,(function(e,s){n=n.pipe((function(){return jQuery("#msg_"+s.action).removeClass("pending").addClass("current"),jQuery(".badge","#msg_"+s.action).html("Working ..."),e=s,jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"sn_ms_run_scan",what:e.action,_ajax_nonce:wf_sn_ms_nonce},dataType:"json",success:function(n){if(null!==n){if(null===n.success)return void alert("Invalid option. Please reload");jQuery("#msg_"+e.action).removeClass("pending").removeClass("current").addClass("passed"),jQuery(".badge","#msg_"+e.action).html(e.msg2.replace("%d",parseInt(n.data.cnt,10))),e.action,"get_results"==e.action&&(jQuery("#sn_ms_results").append(n.data),sn_unblock_ui("#sn-malware-scanner"),jQuery(".loader").show(),window.location.reload())}},error:function(){alert("An undocumented error has occured. Please reload the page and try again.")}});var e}))})),jQuery(".wf-sn-ms-not-run").hide()})),e("#sn_ms_results").on("click",".sn-malware-title",(function(n){n.preventDefault();var s=e(this).parents(".sn-malware-filebox").find(".sn-malware-file-code");e(this).toggleClass("opened"),e(s).slideToggle(500)})),e("#sn-ms-reset-whitelist").on("click",(function(n){n.preventDefault(),confirm("Are you sure you want to reset the whitelisted files list?\nPlease rescan files after cleaning the whitelist.")&&e.post(ajaxurl,{_ajax_nonce:wf_sn_ms_nonce,action:"sn_ms_reset_whitelist"},(function(){window.location.reload()}))})),e("#sn_ms_results").on("click","button.sn_ms_whitelist",(function(n){n.preventDefault(),confirm("Are you sure you want to whitelist this file?")&&(e(this).parents(".sn-malware-filebox").slideUp(500),e.post(ajaxurl,{action:"sn_ms_whitelist_file",hash:e(this).data("hash"),filename:e(this).data("filename"),_ajax_nonce:wf_sn_ms_nonce},(function(){}),"json"))})),e("#sn_ms_results").on("click","button.sn_ms_delete",(function(n){if(n.preventDefault(),confirm("Are you sure you want to delete this file?\n\n There is NO undo!\n\nThis can break functionality or your site from functioning. Use only if you know what you are doing :-)"+e(this).data("filename"))){var s=this;e.post(ajaxurl,{action:"sn_ms_delete_file",filename:e(this).data("filename"),hash:e(this).data("hash"),_ajax_nonce:wf_sn_ms_nonce},(function(n){void 0===n.success?alert("Undocumented error. File was not deleted. Please reload the page."):1==n.success?(alert("File deleted!"),e(s).parents(".sn-malware-filebox").slideUp(500)):alert("Your file access properties do not allow us to delete the file (this is not a bad thing). Please delete it manually, via FTP.")}),"json")}}))}jQuery(ShieldAgainstThirdPartyErrors),window.onerror=function(e,n,s,t,a){return console.error('Error detected: "'+a+'" File:'+n+" Line:"+s+" Column:"+t),ShieldAgainstThirdPartyErrors(jQuery),!0},jQuery(document).ready((function(){}));
//# sourceMappingURL=wf-sn-ms-min.js.map